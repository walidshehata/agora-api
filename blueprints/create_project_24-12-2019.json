{"status":{},"contains_secrets":true,"product_version":"2.9.1","spec":{"description":"","resources":{"client_attrs":{"f2b4956e_deployment":{"y":-5758.3447961388,"x":-2424.0611908589}},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"92840104_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"7b1018fb_runbook","main_task_local_reference":{"kind":"app_task","name":"92840104_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"135ff315_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"646884f6_runbook","main_task_local_reference":{"kind":"app_task","name":"135ff315_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"b24f042f_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"49ea29cd_runbook","main_task_local_reference":{"kind":"app_task","name":"b24f042f_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"2f717727_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"48986340_runbook","main_task_local_reference":{"kind":"app_task","name":"2f717727_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"88981384_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"a24985f1_runbook","main_task_local_reference":{"kind":"app_task","name":"88981384_dag"},"variable_list":[]},"name":"action_restart"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"check_user_exists"},{"kind":"app_task","name":"generate_customer_id"},{"kind":"app_task","name":"get_ad_path"},{"kind":"app_task","name":"create_ad_objects"},{"kind":"app_task","name":"get_network_uuid"},{"kind":"app_task","name":"create_project"},{"kind":"app_task","name":"get_admin_role_uuid"},{"kind":"app_task","name":"get_operator_role_uuid"},{"kind":"app_task","name":"create_admin_group"},{"kind":"app_task","name":"create_operator_group"},{"kind":"app_task","name":"get_project_spec_version"},{"kind":"app_task","name":"update_project"}],"name":"dbed75a4_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"check_user_exists"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"generate_customer_id"}},{"from_task_reference":{"kind":"app_task","name":"generate_customer_id"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"get_ad_path"}},{"from_task_reference":{"kind":"app_task","name":"get_ad_path"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"create_ad_objects"}},{"from_task_reference":{"kind":"app_task","name":"create_ad_objects"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"get_network_uuid"}},{"from_task_reference":{"kind":"app_task","name":"get_network_uuid"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"create_project"}},{"from_task_reference":{"kind":"app_task","name":"get_admin_role_uuid"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"get_operator_role_uuid"}},{"from_task_reference":{"kind":"app_task","name":"get_operator_role_uuid"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"create_admin_group"}},{"from_task_reference":{"kind":"app_task","name":"create_admin_group"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"create_operator_group"}},{"from_task_reference":{"kind":"app_task","name":"create_project"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"get_admin_role_uuid"}},{"from_task_reference":{"kind":"app_task","name":"get_project_spec_version"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"update_project"}},{"from_task_reference":{"kind":"app_task","name":"create_operator_group"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"get_project_spec_version"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"check_user_exists","attrs":{"type":"","interval_secs":1},"timeout_secs":"0","type":"DELAY","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"generate_customer_id","attrs":{"exit_status":[],"script":"id_len = 0\nwhile id_len <> 16:\n    random_id = base64.b64encode(uuid.uuid4().bytes).decode().replace('+', '').replace('\/','')[:16]\n    id_len = len(random_id)\n\nprint(\"RANDOM_ID={}\".format(random_id.upper()))","eval_variables":["RANDOM_ID"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"get_ad_path","attrs":{"exit_status":[],"script":"domain = '@@{DOMAIN}@@'\npath = ''\nif domain[len(domain)-1:] != '.':\n    domain = domain + '.'\n\nwhile domain.find('.') >= 0:\n    x = domain.find('.')\n    path = path + ',DC={}'.format(domain[:x])\n    domain = domain[x+1:]\n\nprint(\"AD_PATH=OU=@@{ROOT_OU}@@,{}\".format(path[1:]))\n","eval_variables":["AD_PATH"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"create_ad_objects","attrs":{"exit_status":[],"script":"\nWrite-Host \"`n====================================================\"\nwrite-Host \"Create OU for new customer\"\nNew-ADOrganizationalUnit -Name \"@@{RANDOM_ID}@@\" -Path \"@@{AD.AD_PATH}@@\" -PassThru\n\nWrite-Host \"`n====================================================\"\nwrite-Host \"Create new customer owner account\"\nNew-ADUser `\n -Name \"@@{FIRST_NAME}@@ @@{LAST_NAME}@@\" `\n -GivenName \"@@{FIRST_NAME}@@\" `\n -Surname \"@@{LAST_NAME}@@\" `\n -SamAccountName \"@@{USERID}@@\" `\n -UserPrincipalName \"@@{USERID}@@@@@{DOMAIN}@@\" `\n -Path \"OU=@@{RANDOM_ID}@@,@@{AD.AD_PATH}@@\" `\n -AccountPassword(ConvertTo-SecureString -asPlainText -Force -String \"@@{PASSWORD}@@\") `\n -EmailAddress \"@@{EMAIL}@@\" `\n -Description \"@@{RANDOM_ID}@@\" `\n -Company \"@@{COMPANY}@@\" `\n -MobilePhone \"@@{MOBILE}@@\" `\n -Enabled $True -PassThru\n \nWrite-Host \"`n====================================================\"\nwrite-Host \"Create Admins group for the new customer\"\n New-ADGroup `\n  -Name \"@@{RANDOM_ID}@@-ADMIN\" `\n  -SamAccountName \"@@{RANDOM_ID}@@-ADMIN\" `\n  -GroupCategory Security -GroupScope Global `\n  -DisplayName \"@@{RANDOM_ID}@@ - Admins\" `\n  -Path \"OU=@@{RANDOM_ID}@@,@@{AD.AD_PATH}@@\" `\n  -PassThru\n\nWrite-Host \"`n====================================================\"\nwrite-Host \"Make admins group primary and remove Domain Users\"\nAdd-ADGroupMember `\n -Identity \"@@{RANDOM_ID}@@-ADMIN\" `\n -Members \"@@{USERID}@@\" `\n -PassThru\n \n$group = get-adgroup \"@@{RANDOM_ID}@@-ADMIN\" -properties @(\"primaryGroupToken\")\nget-aduser \"@@{USERID}@@\" | set-aduser -replace @{primaryGroupID=$group.primaryGroupToken}\n\nRemove-ADGroupMember -Identity \"Domain Users\" -Members \"@@{USERID}@@\" -Confirm:$False -PassThru\n\n\n\nWrite-Host \"`n====================================================\"\nwrite-Host \"Create Operators group for the new customer\"\n New-ADGroup `\n  -Name \"@@{RANDOM_ID}@@-OPERATOR\" `\n  -SamAccountName \"@@{RANDOM_ID}@@-OPERATOR\" `\n  -GroupCategory Security -GroupScope Global `\n  -DisplayName \"@@{RANDOM_ID}@@ - Operators\" `\n  -Path \"OU=@@{RANDOM_ID}@@,@@{AD.AD_PATH}@@\" `\n  -PassThru\n  \n \n \nexit 0\n ","script_type":"npsscript","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"windows_admin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"get_network_uuid","attrs":{"exit_status":[],"script":"#region capture Calm variables\nusername = '@@{pc_admin.username}@@'\nusername_secret = '@@{pc_admin.secret}@@'\npc_address = '@@{PC_IP}@@'\npc_port = '9440'\napi_endpoint = '\/api\/nutanix\/v3\/subnets\/list'\nvlan_name = '@@{PUBLIC_VLAN}@@'\n\nurl = \"https:\/\/{}:{}{}\".format(\n    pc_address,\n    pc_port,\n    api_endpoint\n)\nresult_length = 1000\nmethod = \"POST\"\nheaders = {\n    'Content-Type': 'application\/json',\n    'Accept': 'application\/json'\n}\n\npayload = {\n    \"kind\": \"subnet\",\n    \"filter\": \"name=={}\".format(vlan_name),\n    \"length\":result_length, \n    \"offset\":0\n}\n\n\nprint(\"Making a {} API call to {}\".format(method, url))\nresp = urlreq(\n    url,\n    verb=method,\n    auth='BASIC',\n    user=username,\n    passwd=username_secret,\n    params=json.dumps(payload),\n    headers=headers,\n    verify=False\n)\n\nif resp.ok:\n    public_vlans = []\n    print(\"Request was successful; processing results...\")\n    for vlan in json.loads(resp.content)['entities']:\n        public_vlans.append({'name': vlan['spec']['name'], \n                             'vlan_id': vlan['spec']['resources']['vlan_id'],\n                             'uuid': vlan['metadata']['uuid']})\n    print('Found {} VLANS with name {}...'.format(len(public_vlans), vlan_name))\n    if len(public_vlans) > 0:\n      print('Returning the first entry vlan_id:{}...'.format(public_vlans[0]['vlan_id']))\n      print('PUBLIC_UUID={}'.format(public_vlans[0]['uuid']))\n      exit(0)\n    else:\n      print('No vlans found to return')\n      exit(0)","eval_variables":["PUBLIC_UUID"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"create_project","attrs":{"expected_response_params":[{"status":"SUCCESS","code":202,"type":""}],"request_body":"{\n  \"spec\": {\n    \"name\": \"TENANT-@@{RANDOM_ID}@@\",\n    \"resources\": {\n      \"resource_domain\":{  \n         \"resources\":[  \n            {  \n               \"limit\":40,\n               \"resource_type\":\"VCPUS\"\n            },\n            {  \n               \"limit\":1717986918400,\n               \"resource_type\":\"STORAGE\"\n            },\n            {  \n               \"limit\":85899345920,\n               \"resource_type\":\"MEMORY\"\n            }\n         ]\n      },\n      \"subnet_reference_list\":[  \n         {  \n            \"kind\":\"subnet\",\n            \"name\":\"@@{PUBLIC_VLAN}@@\",\n            \"uuid\":\"@@{PUBLIC_UUID}@@\"\n         }\n      ],\n      \"external_user_group_reference_list\": [\n      ],\n      \"user_reference_list\": [\n      ]\n    },\n    \"description\": \"Project for Tenant @@{RANDOM_ID}@@, created on: xx\"\n  },\n  \"api_version\": \"3.1.0\",\n  \"metadata\": {\n    \"kind\": \"project\",\n    \"spec_version\": 0,\n    \"owner_reference\":{  \n       \"kind\":\"user\",\n       \"uuid\":\"00000000-0000-0000-0000-000000000000\",\n       \"name\":\"admin\"\n    },\n    \"categories\": {\n    }\n  }\n}","headers":[],"url":"https:\/\/@@{PC_IP}@@:9440\/api\/nutanix\/v3\/projects","response_paths":{"PROJ_UUID":"$.metadata.uuid"},"retry_interval":1,"method":"POST","retry_count":1,"authentication":{"type":"basic_with_cred","credential_local_reference":{"kind":"app_credential","name":"pc_admin"}},"tls_verify":false,"content_type":"application\/json","connection_timeout":120,"type":"","proxy_type":""},"timeout_secs":"0","type":"HTTP","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"get_admin_role_uuid","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"{\n  \"filter\": \"name==@@{ROLE_ADMIN}@@\",\n  \"kind\": \"role\",\n  \"offset\": 0,\n  \"length\": 100\n}","headers":[],"url":"https:\/\/@@{PC_IP}@@:9440\/api\/nutanix\/v3\/roles\/list","response_paths":{"ROLE_ADMIN_UUID":"$.entities[0].metadata.uuid"},"retry_interval":1,"method":"POST","retry_count":1,"authentication":{"type":"basic_with_cred","credential_local_reference":{"kind":"app_credential","name":"pc_admin"}},"tls_verify":false,"content_type":"application\/json","connection_timeout":120,"type":"","proxy_type":""},"timeout_secs":"0","type":"HTTP","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"get_operator_role_uuid","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"{\n  \"filter\": \"name==@@{ROLE_OPERATOR}@@\",\n  \"kind\": \"role\",\n  \"offset\": 0,\n  \"length\": 100\n}","headers":[],"url":"https:\/\/@@{PC_IP}@@:9440\/api\/nutanix\/v3\/roles\/list","response_paths":{"ROLE_OPERATOR_UUID":"$.entities[0].metadata.uuid"},"retry_interval":1,"method":"POST","retry_count":1,"authentication":{"type":"basic_with_cred","credential_local_reference":{"kind":"app_credential","name":"pc_admin"}},"tls_verify":false,"content_type":"application\/json","connection_timeout":120,"type":"HTTP","proxy_type":""},"timeout_secs":"0","type":"HTTP","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"create_admin_group","attrs":{"expected_response_params":[{"status":"SUCCESS","code":202,"type":""}],"request_body":"{\n\"spec\": { \"resources\": {\n\"directory_service_user_group\": {\n\"distinguished_name\": \"cn=@@{RANDOM_ID}@@-ADMIN,ou=@@{RANDOM_ID}@@,@@{AD_PATH}@@\"\n} }\n}, \"metadata\": {\n\"kind\": \"user_group\" }\n}\n","headers":[],"url":"https:\/\/@@{PC_IP}@@:9440\/api\/nutanix\/v3\/user_groups","response_paths":{"GROUP_ADMIN_UUID":"$.metadata.uuid"},"retry_interval":1,"method":"POST","retry_count":1,"authentication":{"type":"basic_with_cred","credential_local_reference":{"kind":"app_credential","name":"pc_admin"}},"tls_verify":false,"content_type":"application\/json","connection_timeout":120,"type":"","proxy_type":""},"timeout_secs":"0","type":"HTTP","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"create_operator_group","attrs":{"expected_response_params":[{"status":"SUCCESS","code":202,"type":""}],"request_body":"{\n\"spec\": { \"resources\": {\n\"directory_service_user_group\": {\n\"distinguished_name\": \"cn=@@{RANDOM_ID}@@-OPERATOR,ou=@@{RANDOM_ID}@@,@@{AD_PATH}@@\"\n} }\n}, \"metadata\": {\n\"kind\": \"user_group\" }\n}\n","headers":[],"url":"https:\/\/@@{PC_IP}@@:9440\/api\/nutanix\/v3\/user_groups","response_paths":{"GROUP_OPERATOR_UUID":"$.metadata.uuid"},"retry_interval":1,"method":"POST","retry_count":1,"authentication":{"type":"basic_with_cred","credential_local_reference":{"kind":"app_credential","name":"pc_admin"}},"tls_verify":false,"content_type":"application\/json","connection_timeout":120,"type":"HTTP","proxy_type":""},"timeout_secs":"0","type":"HTTP","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"get_project_spec_version","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","headers":[],"url":"https:\/\/@@{PC_IP}@@:9440\/api\/nutanix\/v3\/projects\/@@{PROJ_UUID}@@","response_paths":{"PROJ_SPEC":"$.metadata.spec_version"},"retry_interval":1,"method":"GET","retry_count":1,"authentication":{"type":"basic_with_cred","credential_local_reference":{"kind":"app_credential","name":"pc_admin"}},"tls_verify":false,"content_type":"application\/json","connection_timeout":120,"type":"","proxy_type":""},"timeout_secs":"0","type":"HTTP","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"update_project","attrs":{"expected_response_params":[{"status":"SUCCESS","code":202,"type":""}],"request_body":"{\n    \"spec\": {\n        \"access_control_policy_list\": [\n            {\n                \"acp\": {\n                    \"name\": \"ACP-TENANT-@@{RANDOM_ID}@@\",\n                    \"resources\": {\n                        \"role_reference\": {\n                            \"kind\": \"role\",\n                            \"uuid\": \"@@{ROLE_ADMIN_UUID}@@\"\n                        },\n                        \"user_group_reference_list\": [\n                            {\n                                \"kind\": \"user_group\",\n                                \"name\": \"cn=@@{RANDOM_ID}@@-admin,ou=@@{RANDOM_ID}@@,@@{AD_PATH}@@\",\n                                \"uuid\": \"@@{GROUP_ADMIN_UUID}@@\"\n                            }\n                        ],\n                        \"user_reference_list\": [],\n                        \"filter_list\": {\n                            \"context_list\": [\n                                {\n                                    \"scope_filter_expression_list\": [\n                                        {\n                                            \"operator\": \"IN\",\n                                            \"left_hand_side\": \"PROJECT\",\n                                            \"right_hand_side\": {\n                                                \"uuid_list\": [\n                                                    \"@@{PROJ_UUID}@@\"\n                                                ]\n                                            }\n                                        }\n                                    ],\n                                    \"entity_filter_expression_list\": [\n                                        {\n                                            \"operator\": \"IN\",\n                                            \"left_hand_side\": {\n                                                \"entity_type\": \"ALL\"\n                                            },\n                                            \"right_hand_side\": {\n                                                \"collection\": \"ALL\"\n                                            }\n                                        }\n                                    ]\n                                },\n                                {\n                                    \"entity_filter_expression_list\": [\n                                        {\n                                            \"operator\": \"IN\",\n                                            \"left_hand_side\": {\n                                                \"entity_type\": \"image\"\n                                            },\n                                            \"right_hand_side\": {\n                                                \"collection\": \"ALL\"\n                                            }\n                                        },\n                                        {\n                                            \"operator\": \"IN\",\n                                            \"left_hand_side\": {\n                                                \"entity_type\": \"marketplace_item\"\n                                            },\n                                            \"right_hand_side\": {\n                                                \"collection\": \"SELF_OWNED\"\n                                            }\n                                        },\n                                        {\n                                            \"operator\": \"IN\",\n                                            \"right_hand_side\": {\n                                                \"collection\": \"ALL\"\n                                            },\n                                            \"left_hand_side\": {\n                                                \"entity_type\": \"app_icon\"\n                                            }\n                                        },\n                                        {\n                                            \"operator\": \"IN\",\n                                            \"right_hand_side\": {\n                                                \"collection\": \"ALL\"\n                                            },\n                                            \"left_hand_side\": {\n                                                \"entity_type\": \"category\"\n                                            }\n                                        },\n                                        {\n                                            \"operator\": \"IN\",\n                                            \"left_hand_side\": {\n                                                \"entity_type\": \"app_task\"\n                                            },\n                                            \"right_hand_side\": {\n                                                \"collection\": \"SELF_OWNED\"\n                                            }\n                                        },\n                                        {\n                                            \"operator\": \"IN\",\n                                            \"left_hand_side\": {\n                                                \"entity_type\": \"app_variable\"\n                                            },\n                                            \"right_hand_side\": {\n                                                \"collection\": \"SELF_OWNED\"\n                                            }\n                                        },\n                                        {\n                                            \"operator\": \"IN\",\n                                            \"left_hand_side\": {\n                                                \"entity_type\": \"cluster\"\n                                            },\n                                            \"right_hand_side\": {\n                                                \"uuid_list\": [\n                                                    \"000597ea-5047-e0bb-1988-ac1f6b6e5577\"\n                                                ]\n                                            }\n                                        }\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    \"description\": \"Admin role for @@{RANDOM_ID}@@\"\n                },\n                \"metadata\": {\n                    \"kind\": \"access_control_policy\"\n                },\n                \"operation\": \"ADD\"\n            },\n            {\n                \"acp\": {\n                    \"name\": \"ACP-TENANT-@@{RANDOM_ID}@@\",\n                    \"resources\": {\n                        \"role_reference\": {\n                            \"uuid\": \"@@{ROLE_OPERATOR_UUID}@@\",\n                            \"kind\": \"role\"\n                        },\n                        \"user_group_reference_list\": [\n                            {\n                                \"kind\": \"user_group\",\n                                \"name\": \"cn=@@{RANDOM_ID}@@-operator,ou=@@{RANDOM_ID}@@,@@{AD_PATH}@@\",\n                                \"uuid\": \"@@{GROUP_OPERATOR_UUID}@@\"\n                            }\n                        ],\n                        \"user_reference_list\": [],\n                        \"filter_list\": {\n                            \"context_list\": [\n                                {\n                                    \"scope_filter_expression_list\": [\n                                        {\n                                            \"operator\": \"IN\",\n                                            \"left_hand_side\": \"PROJECT\",\n                                            \"right_hand_side\": {\n                                                \"uuid_list\": [\n                                                    \"@@{PROJ_UUID}@@\"\n                                                ]\n                                            }\n                                        }\n                                    ],\n                                    \"entity_filter_expression_list\": [\n                                        {\n                                            \"operator\": \"IN\",\n                                            \"left_hand_side\": {\n                                                \"entity_type\": \"ALL\"\n                                            },\n                                            \"right_hand_side\": {\n                                                \"collection\": \"ALL\"\n                                            }\n                                        }\n                                    ]\n                                },\n                                {\n                                    \"entity_filter_expression_list\": [\n                                        {\n                                            \"operator\": \"IN\",\n                                            \"right_hand_side\": {\n                                                \"collection\": \"ALL\"\n                                            },\n                                            \"left_hand_side\": {\n                                                \"entity_type\": \"app_icon\"\n                                            }\n                                        },\n                                        {\n                                            \"operator\": \"IN\",\n                                            \"right_hand_side\": {\n                                                \"collection\": \"ALL\"\n                                            },\n                                            \"left_hand_side\": {\n                                                \"entity_type\": \"category\"\n                                            }\n                                        },\n                                        {\n                                            \"operator\": \"IN\",\n                                            \"left_hand_side\": {\n                                                \"entity_type\": \"cluster\"\n                                            },\n                                            \"right_hand_side\": {\n                                                \"uuid_list\": [\n                                                    \"000597ea-5047-e0bb-1988-ac1f6b6e5577\"\n                                                ]\n                                            }\n                                        }\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    \"description\": \"Operator role for @@{RANDOM_ID}@@\"\n                },\n                \"metadata\": {\n                    \"kind\": \"access_control_policy\"\n                },\n                \"operation\": \"ADD\"\n            }\n        ],\n        \"project_detail\": {\n            \"name\": \"TENANT-@@{RANDOM_ID}@@\",\n            \"resources\": {\n                \"resource_domain\": {\n                    \"resources\": [\n                        {\n                            \"limit\": 40,\n                            \"resource_type\": \"VCPUS\"\n                        },\n                        {\n                            \"limit\": 1717986918400,\n                            \"resource_type\": \"STORAGE\"\n                        },\n                        {\n                            \"limit\": 85899345920,\n                            \"resource_type\": \"MEMORY\"\n                        }\n                    ]\n                },\n                \"account_reference_list\": [\n                    {\n                        \"uuid\": \"730764a2-d81c-48fa-8c25-22c01fd21633\",\n                        \"kind\": \"account\",\n                        \"name\": \"nutanix_pc\"\n                    }\n                ],\n                \"external_user_group_reference_list\": [\n                    {\n                        \"kind\": \"user_group\",\n                        \"name\": \"cn=@@{RANDOM_ID}@@-ADMIN,ou=@@{RANDOM_ID}@@,@@{AD_PATH}@@\",\n                        \"uuid\": \"@@{GROUP_ADMIN_UUID}@@\"\n                    },\n                    {\n                        \"kind\": \"user_group\",\n                        \"name\": \"cn=@@{RANDOM_ID}@@-OPERATOR,ou=@@{RANDOM_ID}@@,@@{AD_PATH}@@\",\n                        \"uuid\": \"@@{GROUP_OPERATOR_UUID}@@\"\n                    }\n                ],\n                \"user_reference_list\": [],\n                \"subnet_reference_list\": [\n                    {\n                        \"kind\": \"subnet\",\n                        \"name\": \"@@{PUBLIC_VLAN}@@\",\n                        \"uuid\": \"@@{PUBLIC_UUID}@@\"\n                    }\n                ],\n                \"external_network_list\": [],\n                \"default_subnet_reference\": {\n                    \"kind\": \"subnet\",\n                    \"uuid\": \"@@{PUBLIC_UUID}@@\"\n                }\n            }\n        }\n    },\n    \"api_version\": \"3.1\",\n    \"metadata\": {\n        \"kind\": \"project\",\n        \"uuid\": \"@@{PROJ_UUID}@@\",\n        \"spec_version\": @@{PROJ_SPEC}@@,\n        \"owner_reference\": {\n            \"kind\": \"user\",\n            \"uuid\": \"00000000-0000-0000-0000-000000000000\",\n            \"name\": \"admin\"\n        }\n    }\n}","headers":[],"url":"https:\/\/@@{PC_IP}@@:9440\/api\/nutanix\/v3\/projects_internal\/@@{PROJ_UUID}@@","response_paths":{},"retry_interval":1,"method":"PUT","retry_count":1,"authentication":{"type":"basic_with_cred","credential_local_reference":{"kind":"app_credential","name":"pc_admin"}},"tls_verify":false,"content_type":"application\/json","connection_timeout":120,"type":"","proxy_type":""},"timeout_secs":"0","type":"HTTP","variable_list":[]}],"description":"","name":"eca8969d_runbook","main_task_local_reference":{"kind":"app_task","name":"dbed75a4_dag"},"variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"FIRST_NAME","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"LAST_NAME","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"USERID","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"SECRET","name":"PASSWORD","value":"98icrXUwDZNls8HhYLY9KBHIQGd5G0bkODm+jy8J5rI9OT04xQF4SuXO:utf-8","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"EMAIL","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"MOBILE","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"COMPANY","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]},"name":"create_new_tenant"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"get_public_vlan_uuid"},{"kind":"app_task","name":"print_uuid"}],"name":"d31b8e8e_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"get_public_vlan_uuid"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"print_uuid"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"get_public_vlan_uuid","attrs":{"exit_status":[],"script":"#region capture Calm variables\nusername = '@@{pc_admin.username}@@'\nusername_secret = '@@{pc_admin.secret}@@'\npc_address = '@@{PC_IP}@@'\npc_port = '9440'\napi_endpoint = '\/api\/nutanix\/v3\/subnets\/list'\nvlan_name = '@@{PUBLIC_VLAN}@@'\n\nurl = \"https:\/\/{}:{}{}\".format(\n    pc_address,\n    pc_port,\n    api_endpoint\n)\nresult_length = 1000\nmethod = \"POST\"\nheaders = {\n    'Content-Type': 'application\/json',\n    'Accept': 'application\/json'\n}\n\npayload = {\n    \"kind\": \"subnet\",\n    \"filter\": \"name=={}\".format(vlan_name),\n    \"length\":result_length, \n    \"offset\":0\n}\n\n\nprint(\"Making a {} API call to {}\".format(method, url))\nresp = urlreq(\n    url,\n    verb=method,\n    auth='BASIC',\n    user=username,\n    passwd=username_secret,\n    params=json.dumps(payload),\n    headers=headers,\n    verify=False\n)\n\nif resp.ok:\n    public_vlans = []\n    print(\"Request was successful; processing results...\")\n    for vlan in json.loads(resp.content)['entities']:\n        public_vlans.append({'name': vlan['spec']['name'], \n                             'vlan_id': vlan['spec']['resources']['vlan_id'],\n                             'uuid': vlan['metadata']['uuid']})\n    print('Found {} VLANS with name {}...'.format(len(public_vlans), vlan_name))\n    if len(public_vlans) > 0:\n      print('Returning the first entry vlan_id:{}...'.format(public_vlans[0]['vlan_id']))\n      print('PUBLIC_UUID={}'.format(public_vlans[0]['uuid']))\n      exit(0)\n    else:\n      print('No vlans found to return')\n      exit(0)","eval_variables":["PUBLIC_UUID"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"print_uuid","attrs":{"script":"print('@@{PUBLIC_UUID}@@')","type":"","command_line_args":"","exit_status":[],"script_type":"static"},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"c2dbf6bb_runbook","main_task_local_reference":{"kind":"app_task","name":"d31b8e8e_dag"},"variable_list":[]},"name":"get_network"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"get_user_uuid"},{"kind":"app_task","name":"get_network_uuid"}],"name":"2537ed74_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"get_user_uuid"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"get_network_uuid"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"get_user_uuid","attrs":{"type":"","interval_secs":1},"timeout_secs":"0","type":"DELAY","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"get_network_uuid","attrs":{"exit_status":[],"script":"#region capture Calm variables\nusername = '@@{pc_admin.username}@@'\nusername_secret = '@@{pc_admin.secret}@@'\npc_address = '@@{PC_IP}@@'\npc_port = '9440'\napi_endpoint = '\/api\/nutanix\/v3\/subnets\/list'\nvlan_name = '@@{PUBLIC_VLAN}@@'\n\nurl = \"https:\/\/{}:{}{}\".format(\n    pc_address,\n    pc_port,\n    api_endpoint\n)\nresult_length = 1000\nmethod = \"POST\"\nheaders = {\n    'Content-Type': 'application\/json',\n    'Accept': 'application\/json'\n}\n\npayload = {\n    \"kind\": \"subnet\",\n    \"filter\": \"name=={}\".format(vlan_name),\n    \"length\":result_length, \n    \"offset\":0\n}\n\n\nprint(\"Making a {} API call to {}\".format(method, url))\nresp = urlreq(\n    url,\n    verb=method,\n    auth='BASIC',\n    user=username,\n    passwd=username_secret,\n    params=json.dumps(payload),\n    headers=headers,\n    verify=False\n)\n\nif resp.ok:\n    public_vlans = []\n    print(\"Request was successful; processing results...\")\n    for vlan in json.loads(resp.content)['entities']:\n        public_vlans.append({'name': vlan['spec']['name'], \n                             'vlan_id': vlan['spec']['resources']['vlan_id'],\n                             'uuid': vlan['metadata']['uuid']})\n    print('Found {} VLANS with name {}...'.format(len(public_vlans), vlan_name))\n    if len(public_vlans) > 0:\n      print('Returning the first entry vlan_id:{}...'.format(public_vlans[0]['vlan_id']))\n      print('PUBLIC_UUID={}'.format(public_vlans[0]['uuid']))\n      exit(0)\n    else:\n      print('No vlans found to return')\n      exit(0)","eval_variables":["PUBLIC_UUID"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]}],"description":"","name":"deb8ab86_runbook","main_task_local_reference":{"kind":"app_task","name":"2537ed74_dag"},"variable_list":[]},"name":"create_new_project"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"get cluster"},{"kind":"app_task","name":"Task2"},{"kind":"app_task","name":"Task3"}],"name":"03edd874_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"get cluster"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Task2"}},{"from_task_reference":{"kind":"app_task","name":"Task2"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Task3"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"get cluster","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"{\n  \"filter\": \"\",\n  \"kind\": \"cluster\",\n  \"offset\": 0,\n  \"length\": 100\n}","headers":[],"url":"https:\/\/@@{PC_IP}@@:9440\/api\/nutanix\/v3\/clusters\/list","response_paths":{"NETWORK_UUID":"@.entities"},"retry_interval":1,"method":"POST","retry_count":1,"authentication":{"type":"basic_with_cred","credential_local_reference":{"kind":"app_credential","name":"pc_admin"}},"tls_verify":false,"content_type":"application\/json","connection_timeout":120,"type":"","proxy_type":""},"timeout_secs":"0","type":"HTTP","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Task2","attrs":{"script":"var = \"@@{NETWORK_UUID}@@\"\nprint(var)","type":"","command_line_args":"","exit_status":[],"script_type":"static"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Task3","attrs":{"script":"var = json.loads(\"@@{NETWORK_UUID}@@\")\nprint(var)","type":"","command_line_args":"","exit_status":[],"script_type":"static"},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"75b3bb2d_runbook","main_task_local_reference":{"kind":"app_task","name":"03edd874_dag"},"variable_list":[]},"name":"Get Cluster UUIDs"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"check_username_unique"},{"kind":"app_task","name":"project_variables"}],"name":"dbed75a4_dag_cloned_1","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"check_username_unique"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"project_variables"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"check_username_unique","attrs":{"type":"","interval_secs":1},"timeout_secs":"0","type":"DELAY","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"project_variables","attrs":{"script":"\n\n\n# gerneating a new tenant random ID\n# ================================================================\ndef generate_random_id():\n  id_len = 0\n  while id_len <> 16:\n      random_id = base64.b64encode(uuid.uuid4().bytes).decode().replace('+', '').replace('\/','')[:16]\n      radom_id = random_id.upper()\n      if tenant_id_is_unique(random_id):\n          id_len = len(random_id)\n      else:\n          id_len = 0\n      \n\n  return random_id.upper()\n  \n\n# api call function\n# ================================================================\ndef http_request(api_endpoint, payload='', method='POST'):\n  username = '@@{pc_admin.username}@@'\n  username_secret = '@@{pc_admin.secret}@@'\n  pc_address = '@@{PC_IP}@@'\n  pc_port = '9440'\n\n  url = \"https:\/\/{}:{}{}\".format(\n      pc_address,\n      pc_port,\n      api_endpoint\n  )\n  \n  headers = {\n      'Content-Type': 'application\/json',\n      'Accept': 'application\/json'\n  }\n  \n  if len(payload) > 0:\n      payload = json.dumps(payload)\n      \n  \n  resp = urlreq(\n      url,\n      verb=method,\n      auth='BASIC',\n      user=username,\n      passwd=username_secret,\n      params=payload,\n      headers=headers,\n      verify=False\n  )\n  \n  if resp.ok:\n      return json.loads(resp.content)\n  else:\n      print('Error in API call')\n      exit(1)\n\n\n# check if generated ID is unique and never used before\n# ----------------------------------------------------------\ndef tenant_id_is_unique(_id):\n    api_endpoint = '\/api\/nutanix\/v3\/projects\/list'\n    payload = {\n        \"filter\": \"name==TENANT-{}\".format(_id),\n        \"kind\": \"project\",\n        \"length\": 10\n    }\n    \n    resp = http_request(api_endpoint, payload)\n    if resp['metadata']['length'] == 0:\n        return True\n    else:\n        return False\n    \n# convert domain name to Microsoft AD path\n# -----------------------------------------------------------\ndef convert_domain_to_ad_path(domain, root_ou):\n    path = ''\n    if domain[len(domain)-1:] != '.':\n        domain = domain + '.'\n    \n    while domain.find('.') >= 0:\n        x = domain.find('.')\n        path = path + ',DC={}'.format(domain[:x])\n        domain = domain[x+1:]\n    \n    return '{},{}'.format(root_ou, path[1:])\n    \n\n# get public networks UUIDs\n# -----------------------------------------------------------\ndef get_public_networks(label='@@{PUBLIC_VLAN}@@', owner='ALL'):\n    api_endpoint = '\/api\/nutanix\/v3\/subnets\/list'\n    payload = {\n        'kind': 'subnet',\n        'filter': 'name==.*[{}].*'.format(label),\n        \"offset\":0\n    }\n    \n    public_vlans = []\n    vlans = http_request(api_endpoint, payload)\n    for vlan in vlans['entities']:\n        if vlan['metadata']['categories']['OWNER'] == owner:\n            public_vlans.append({\n                                'name': vlan['spec']['name'],\n                                'vlan_id': vlan['spec']['resources']['vlan_id'],\n                                'uuid': vlan['metadata']['uuid'],\n                                'cluster_uuid': vlan['spec']['cluster_reference']['uuid']\n                                })\n                            \n    return public_vlans\n\n\n# get role UUID using role name (returns first result only)\n# ------------------------------------------------------------\ndef get_role_uuid(role_name):\n  api_endpoint = '\/api\/nutanix\/v3\/roles\/list'\n  payload = {\n      'filter': 'name=={}'.format(role_name),\n      'kind': 'role',\n      'offset': 0\n  }\n  result = http_request(api_endpoint, payload)\n  if result['entities']:\n      return result['entities'][0]['metadata']['uuid']\n  else:\n      return None\n\n\n\nvar_id = generate_random_id()\nad_path = convert_domain_to_ad_path('@@{DOMAIN}@@', '@@{ROOT_OU}@@')\npublic_vlans = get_public_networks(label='@@{PUBLIC_VLAN}@@')\nadmin_role_uuid = get_role_uuid('@@{ROLE_ADMIN}@@')\noperator_role_uuid = get_role_uuid('@@{ROLE_OPERATOR}@@')\n\n\nprint('RANDOM_ID={}'.format(var_id))\nprint('AD_PATH=OU={}'.format(ad_path))\nprint('PUBLIC_VLANS={}'.format(json.dumps(public_vlans)))\nprint('ROLE_ADMIN_UUID={}'.format(admin_role_uuid))\nprint('ROLE_OPERATOR_UUID={}'.format(operator_role_uuid))\n","type":"","command_line_args":"","exit_status":[],"script_type":"static"},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"eca8969d_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"dbed75a4_dag_cloned_1"},"variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"FIRST_NAME","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"LAST_NAME","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"USERID","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"SECRET","name":"PASSWORD","value":"GjZ\/eFnGqWf\/qMSvUV+qyEcq4Q7Qgo7XCPBNP4wXxD8ZL5O7:ascii","label":"","is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"EMAIL","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"MOBILE","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"COMPANY","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]},"name":"onboard"}],"depends_on_list":[],"name":"AD","port_list":[],"tier":"","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"RANDOM_ID","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"AD_PATH","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"PUBLIC_UUID","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"PROJ_UUID","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"AD_UUID","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"ROLE_ADMIN_UUID","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"ROLE_OPERATOR_UUID","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"GROUP_ADMIN_UUID","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"GROUP_OPERATOR_UUID","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"PROJ_SPEC","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"CLUSTER_UUIDS","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"NETWORK_UUID","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"PUBLIC_VLANS","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}],"description":""}],"substrate_definition_list":[{"description":"","action_list":[{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"AD_VM"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"2fece383_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"c462f094_runbook","main_task_local_reference":{"kind":"app_task","name":"2fece383_dag"},"variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"RANDOM_ID","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]},"name":"pre_action_create"},{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"AD_VM"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"47154cfe_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"755a0f4d_runbook","main_task_local_reference":{"kind":"app_task","name":"47154cfe_dag"},"variable_list":[]},"name":"post_action_delete"}],"type":"EXISTING_VM","name":"AD_VM","readiness_probe":{"connection_type":"POWERSHELL","retries":"5","connection_protocol":"","connection_port":5985,"address":"@@{ip_address}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"windows_admin"}},"os_type":"Windows","create_spec":{"type":"","address":"@@{AD_IP}@@"},"variable_list":[]}],"credential_definition_list":[{"username":"administrator@demo.lan","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"7X4F6gIzQmhIGWmmcn6jDUn4kHsqpnM4sCgSBDYrqX3wxT57m3R8USG1Yw==:utf-8"},"name":"windows_admin"},{"username":"admin","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"EgCzL2s1KdnV1zbbcDvQk1FL5Rb1rafnDDz\/kvuj8CoslPMRVxVUITvSJw==:utf-8"},"name":"pc_admin"}],"package_definition_list":[{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"AD"}],"name":"Package1","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package1"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"06b33d40_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"407376ab_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"06b33d40_dag"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package1"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"c9e2236f_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"a74dfe66_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"c9e2236f_dag"},"message_list":[],"variable_list":[]}},"variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"f2b4956e_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"Package1"}],"substrate_local_reference":{"kind":"app_substrate","name":"AD_VM"},"variable_list":[],"description":""}],"description":"","action_list":[{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"create_new_objects"}],"name":"940985d3_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"create_new_objects","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"eca8969d_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"a5c338da_runbook","main_task_local_reference":{"kind":"app_task","name":"940985d3_dag"},"variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"FIRST_NAME","value":"","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"LAST_NAME","value":"","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"USERID","value":"","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"SECRET","name":"PASSWORD","value":"QFDc5lFhsdbxhvDkIg4KtuEr2JD158wgIZH7UDfIaxuptBy8\/nfshEvJ:utf-8","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"EMAIL","value":"","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"MOBILE","value":"","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"COMPANY","value":"","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]},"name":"onboard_new_customer"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"onboard"}],"name":"62b6814a_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"AD"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"onboard","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"eca8969d_runbook_cloned_0"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"2944af05_runbook","main_task_local_reference":{"kind":"app_task","name":"62b6814a_dag"},"variable_list":[]},"name":"Action2"}],"name":"Default","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"PC_IP","value":"10.38.10.73","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"AD_IP","value":"10.38.10.88","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"DOMAIN","value":"demo.lan","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"PUBLIC_VLAN","value":"PUBLIC","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"AD_NAME","value":"DC","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"ROLE_ADMIN","value":"Consumer","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"ROLE_OPERATOR","value":"Operator","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"ROOT_OU","value":"Tenants","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]}],"published_service_definition_list":[],"default_credential_local_reference":{"kind":"app_credential","name":"windows_admin"},"type":"USER"},"name":"create_project"},"api_version":"3.0","metadata":{"last_update_time":"1576755242174455","kind":"blueprint","spec_version":43,"creation_time":"1575899938870266","name":"create_project"}}